<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.mjbmall.orders.dao.OrdersMapper">
    <select id="getAdrressList"  resultType="com.mjbmall.orders.entity.Address" parameterType="int">
	   select * from 
       m_receiptads
        <where>
		 	user_id=#{0}
		</where>
	</select>
	<select id="getCart"  resultType="com.mjbmall.orders.entity.Carts">
	    select a.goods_id,a.name,a.price,a.mktprice,a.big_pic,date_format(b.addTime,'%Y-%c-%d %H:%i:%s'),c.shop_id,c.shop_name from sdb_b2c_goods a,m_cart b,m_shop c
        <where>
		 	a.goods_id=b.goods_id and b.user_id=#{0}
	        and store &gt; 0 and a.shop_id=c.shop_id
		</where>
	</select>
	<insert id="addCarts" parameterType="int">  
       insert into m_cart (user_id,goods_id,addTime,count,shop_id) 
       values(#{param1},#{param2},NOW(),#{param3},#{param4}
       	)  
    </insert> 
    <delete id="delCarts" parameterType="int">
		delete from m_cart
		where user_id=#{0} and goods_id=#{1}
	</delete>
	<update id="updateCarts" parameterType="int">
		update m_cart
		set count=#{0}
		where user_id=#{1} and goods_id=#{2}
	</update>
	<update id="goreckoning" parameterType="com.mjbmall.orders.entity.Reckoning">
		update m_cart
		set reckoning=#{reckoning}
		where user_id=#{user_id} 
		<if test='goodsId != null &amp;&amp; goodsId.length!=0'>
			 and goods_id in
			 <foreach item="goodsId" index="index" collection="goodsId" open="(" separator="," close=")">  
            #{goodsId}  
        </foreach>
		 </if>
		
		<!--<if test='good_id != null &amp;&amp; good_id!=0'>
			 and goods_id=#{good_id}
		</if>
		
	--></update>
	<select id="getreckoning"  resultType="com.mjbmall.orders.entity.Carts" parameterType="int">
	    select a.goods_id,a.name,a.price,a.mktprice,a.big_pic,date_format(b.addTime,'%Y-%c-%d %H:%i:%s'),c.shop_id,c.shop_name from sdb_b2c_goods a,m_cart b,m_shop c
        <where>
		 	a.goods_id=b.goods_id and b.user_id=#{0}
	        and store &gt; 0 and a.shop_id=c.shop_id and reckoning=1
		</where>
	</select>
	<!--<select id="getreckoning" parameterType="int">
	   select * from 
	
	</select>
	-->
	
</mapper>